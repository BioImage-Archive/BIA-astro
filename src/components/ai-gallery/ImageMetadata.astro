---
const { imageRep, imageAtrributes, text} = Astro.props;

function getMicronSize(rep) {
  if (!rep?.voxel_physical_size_x || !rep?.voxel_physical_size_y) return ["0", "0"];
  return [
    (1e6 * rep.voxel_physical_size_x ** 2).toPrecision(2),
    (1e6 * rep.voxel_physical_size_y ** 2).toPrecision(2),
  ];
}

const [tissue_x, tissue_y] = getMicronSize(imageRep);

const divID = text == "Annotation"? "annotated-metadata": "source-metadata";
const sizeSpan = text == "Annotation"? "annotated-size": "source-size";
const pxielSpan = text == "Annotation"? "annotated-pixels": "source-pixels";
const channelSpan = text == "Annotation"? "annotated-channels": "source-channels";
const timestepSpan = text == "Annotation"? "annotated-timesteps": "source-timesteps";
---
<h3>Image metadata</h3>
    <b>Image size: </b> <span id={sizeSpan}>{tissue_x}μm x {tissue_y}μm</span><br>
    <span id={pxielSpan}>{imageRep?.size_x} x {imageRep?.size_y} pixels</span><br />
    <span id={channelSpan}>{imageRep?.size_c} channels</span><br />
    <span id={timestepSpan}>{imageRep?.size_t} timesteps</span>
    <br /> <br />
    <div id={divID}>
    {
      imageAtrributes && Object.keys(imageAtrributes).length === 0 ? <span></span> : (
        <>
          <h3>Additional metadata</h3>
          {Object.entries(imageAtrributes).map(([key, value]) => (
            <>
            <b>{key}:</b> {value}<br />
        </>
        ))}
        </>
      )
    }
    </div>
